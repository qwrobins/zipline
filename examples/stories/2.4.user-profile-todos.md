# Story 2.4: User Profile - Todos Tab

## Status
Approved

## Story
**As a** user,
**I want** to see all todos for a specific user on their profile,
**so that** I can understand what tasks they're working on.

## Acceptance Criteria
1. "Todos" tab added to user profile tabbed interface
2. Todos tab displays all todos for that user in a list format
3. Each todo shows: title, completion checkbox (checked/unchecked based on `completed` status)
4. Todo count displayed in tab label with completion summary (e.g., "Todos (8/20)")
5. Completed todos visually distinguished (strikethrough text, muted color)
6. Empty state message if user has no todos
7. Loading skeleton shown while todos are being fetched
8. API efficiently fetches only todos for this user (`/users/{id}/todos` or filtered)
9. Todos are displayed but not yet interactive (toggle functionality in Epic 4)

## Tasks / Subtasks
- [ ] Add Todos tab to user profile tabbed interface (AC: 1)
  - [ ] Update user profile page component to include Todos tab using shadcn/ui Tabs
  - [ ] Configure tab ordering (Posts, Todos)
  - [ ] Verify tab navigation works correctly
- [ ] Implement todos data fetching (AC: 2, 8)
  - [ ] Create API service function to fetch todos for specific user
  - [ ] Create React Query hook for user todos with proper query key structure
  - [ ] Integrate hook into Todos tab component
  - [ ] Verify API endpoint uses efficient user-filtered request
- [ ] Create TodoList component for user profile (AC: 2, 3, 5)
  - [ ] Build TodoList component to display todos in list format
  - [ ] Create TodoItem component with title and checkbox display
  - [ ] Implement visual distinction for completed todos (strikethrough, muted color)
  - [ ] Ensure checkbox displays correct state but is not interactive
  - [ ] Apply proper styling with Tailwind CSS
- [ ] Implement todo count display in tab label (AC: 4)
  - [ ] Calculate total todos count from fetched data
  - [ ] Calculate completed todos count from fetched data
  - [ ] Display format: "Todos (completed/total)"
  - [ ] Update tab label dynamically based on data
- [ ] Add loading skeleton state (AC: 7)
  - [ ] Create skeleton components for todo list items
  - [ ] Display skeletons while query is loading
  - [ ] Ensure smooth transition from skeleton to actual data
- [ ] Implement empty state (AC: 6)
  - [ ] Create empty state message component
  - [ ] Display when user has no todos
  - [ ] Include appropriate messaging and styling
- [ ] Test todos tab functionality (AC: 1-9)
  - [ ] Verify tab appears and is clickable
  - [ ] Verify correct todos are fetched for specific user
  - [ ] Verify count display is accurate
  - [ ] Verify completed/incomplete visual distinction
  - [ ] Verify loading states work correctly
  - [ ] Verify empty state displays when appropriate
  - [ ] Verify checkboxes are non-interactive

## Dev Notes

### Data Models
[Source: docs/architecture/data-models.md]

**Todo Interface:**
```typescript
interface Todo {
  id: number;
  userId: number;
  title: string;
  completed: boolean;
}
```

**Relationships:**
- Many-to-one with User (todos.userId → users.id)

### Component Structure
[Source: docs/architecture/components.md]

**Required Components:**
- `TodoList`: List of todos with filters (reusable from todos page)
- `TodoItem`: Single todo with checkbox and actions

**Component Location:**
[Source: docs/architecture/unified-project-structure.md]
```
components/
├── todos/
│   ├── todo-list.tsx
│   └── todo-item.tsx
```

### API Service Layer
[Source: docs/architecture/components.md]

**API Functions Required:**
- `fetchTodos(userId?: number)`: Fetch todos with optional user filter

**Technology Stack:** TypeScript, Zod for runtime validation

### React Query Hooks
[Source: docs/architecture/components.md, docs/architecture/frontend-architecture.md]

**Required Hook:**
- `useTodos(userId?, status?)`: Query hook for todos with filters

**Query Key Structure:**
```typescript
queryKeys.todos = {
  all: ['todos'] as const,
  lists: () => [...queryKeys.todos.all, 'list'] as const,
  list: (filters: TodoFilters) => [...queryKeys.todos.lists(), filters] as const,
}
```

**React Query Configuration:**
[Source: docs/architecture/frontend-architecture.md]
```typescript
{
  staleTime: 5 * 60 * 1000, // 5 minutes
  cacheTime: 10 * 60 * 1000, // 10 minutes
  retry: 2,
  refetchOnWindowFocus: false,
}
```

### UI Components
[Source: docs/architecture/tech-stack.md]

**shadcn/ui Components Required:**
- Tabs component (already in use for Posts tab from Story 2.3)
- Card component for todo items
- Skeleton component for loading states
- Badge component for count display

### Styling Guidelines
[Source: docs/architecture/coding-standards.md]

**Completed Todo Visual Treatment:**
- Use Tailwind classes for strikethrough: `line-through`
- Use muted text color: `text-muted-foreground`
- Example: `className="line-through text-muted-foreground"`

**CSS Classes:** kebab-case (Tailwind utility classes)

### File Naming Conventions
[Source: docs/architecture/coding-standards.md]
- Components: PascalCase (e.g., `TodoList.tsx`, `TodoItem.tsx`)
- Hooks: camelCase with 'use' prefix (e.g., `useTodos.ts`)

### API Response Validation
[Source: docs/architecture/coding-standards.md]

**Critical Rule:** All API responses must be validated with Zod schemas before use

**Schema Example:**
```typescript
// lib/api/schemas.ts
import { z } from 'zod';

export const todoSchema = z.object({
  id: z.number(),
  userId: z.number(),
  title: z.string(),
  completed: z.boolean(),
});

export const todoArraySchema = z.array(todoSchema);
```

### JSONPlaceholder API Endpoints
[Source: docs/architecture/components.md]

**Endpoint:** `/users/{id}/todos` or `/todos?userId={id}`
- Returns all todos for specific user
- Efficient filtering on server side

### Accessibility Requirements
[Source: docs/architecture/coding-standards.md]

**Critical Rule:** All interactive elements must have proper ARIA labels and keyboard navigation

**For this story:**
- Checkboxes should have `aria-checked` attribute
- Tab navigation should be keyboard accessible (handled by shadcn/ui Tabs)
- Empty state should be announced to screen readers

### Loading States
[Source: docs/architecture/coding-standards.md]

**Critical Rule:** Always show skeletons during data fetching; never blank screens

**Implementation:**
- Use shadcn/ui Skeleton component
- Match skeleton structure to actual TodoItem layout
- Display multiple skeleton items (e.g., 5-8) to simulate list

### Non-Interactive Checkbox Note
[Source: Epic requirements]

**Important:** Checkboxes should display completion status but NOT be clickable in this story. Toggle functionality will be implemented in Epic 4. Consider using a disabled checkbox or a visual-only element.

### Testing
[Source: docs/architecture/testing-strategy.md]

**Unit Tests Required:**
- `tests/unit/components/todos/todo-list.test.tsx`
- `tests/unit/components/todos/todo-item.test.tsx`
- `tests/unit/hooks/use-todos.test.ts`

**Integration Tests Required:**
- Verify todos tab displays correct user's todos
- Verify completed/incomplete visual distinction
- Verify count calculation accuracy
- Verify loading and empty states

**E2E Tests Required:**
- Navigate to user profile and verify Todos tab exists
- Click Todos tab and verify todos load
- Verify completed todos show strikethrough
- Verify count display matches actual todos

**Test Coverage Target:** 70%+ component and utility coverage

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-09-30 | 1.0 | Initial story creation | Bob (Scrum Master) |

## Dev Agent Record

### Agent Model Used
_To be filled by Dev Agent_

### Debug Log References
_To be filled by Dev Agent_

### Completion Notes
_To be filled by Dev Agent_

### File List
_To be filled by Dev Agent_

## QA Results
_To be filled by QA Agent_