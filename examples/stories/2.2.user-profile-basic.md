# Story 2.2: User Profile - Basic Information

## Status
Approved

## Story
**As a** user,
**I want** to view detailed information about a specific user,
**so that** I can learn more about an author.

## Acceptance Criteria
1. User profile page created at `/users/[id]` route
2. Profile header displays: large avatar, name, username, email
3. Contact information section shows: phone, website (as clickable link)
4. Company information section shows: company name, catch phrase, business type (bs)
5. Address section shows: street, suite, city, zipcode
6. Static map placeholder image displayed for address (can be a simple colored box with "Map" text)
7. Loading skeleton shown while user data is being fetched
8. Error handling for missing user (404 state)
9. Breadcrumb navigation back to users directory

## Tasks / Subtasks
- [ ] Create user profile page route (AC: 1)
  - [ ] Create `/app/users/[id]/page.tsx` with dynamic route parameter
  - [ ] Set up page metadata with dynamic user name
  - [ ] Mark as client component for interactivity
- [ ] Implement API service for single user (AC: 1, 8)
  - [ ] Add `fetchUser(id: number)` function to `lib/api/users.ts`
  - [ ] Use existing Zod schema validation for User type
  - [ ] Add error handling for 404 responses
- [ ] Create React Query hook for single user (AC: 1, 7, 8)
  - [ ] Add `useUser(id: number)` query hook to `lib/hooks/use-users.ts`
  - [ ] Configure proper query key with user ID
  - [ ] Implement loading and error states
  - [ ] Add retry logic for failed requests
- [ ] Create UserProfile component (AC: 2-6)
  - [ ] Create `components/users/user-profile.tsx` with section layout
  - [ ] Implement profile header section
  - [ ] Implement contact information section
  - [ ] Implement company information section
  - [ ] Implement address section
  - [ ] Add responsive layout for mobile and desktop
- [ ] Implement profile header (AC: 2)
  - [ ] Display large UserAvatar component
  - [ ] Display user name as h1 heading
  - [ ] Display username with @ symbol
  - [ ] Display email with proper styling
  - [ ] Use Card component for header container
- [ ] Implement contact information section (AC: 3)
  - [ ] Display phone number with icon
  - [ ] Display website as clickable link (opens in new tab)
  - [ ] Add proper link styling and hover states
  - [ ] Use Card component for section
- [ ] Implement company information section (AC: 4)
  - [ ] Display company name as section heading
  - [ ] Display catch phrase with italic styling
  - [ ] Display business type (bs)
  - [ ] Use Card component for section
- [ ] Implement address section (AC: 5, 6)
  - [ ] Display full address (street, suite, city, zipcode)
  - [ ] Create static map placeholder component
  - [ ] Display placeholder with colored background and "Map" text
  - [ ] Make map placeholder responsive (400x200px on desktop)
  - [ ] Use Card component for section
- [ ] Create loading state (AC: 7)
  - [ ] Create `/app/users/[id]/loading.tsx` with skeleton
  - [ ] Use Skeleton components matching profile layout
  - [ ] Include skeletons for header, contact, company, address sections
- [ ] Implement error handling (AC: 8)
  - [ ] Create custom 404 state for missing user
  - [ ] Display "User not found" message
  - [ ] Add link to return to user directory
  - [ ] Handle API errors with error boundary
- [ ] Add breadcrumb navigation (AC: 9)
  - [ ] Create breadcrumb component showing: Home > Users > [Username]
  - [ ] Make breadcrumb links clickable
  - [ ] Position at top of page
  - [ ] Use semantic nav element

## Dev Notes

### Route Structure
[Source: docs/architecture/unified-project-structure.md]

Create the following files:
```
app/
├── users/
│   └── [id]/
│       ├── page.tsx       # User profile page
│       └── loading.tsx    # Loading skeleton
```

### Data Model
[Source: docs/architecture/data-models.md]

Use the complete User interface with nested address and company objects:
```typescript
interface User {
  id: number;
  name: string;
  username: string;
  email: string;
  address: {
    street: string;
    suite: string;
    city: string;
    zipcode: string;
    geo: {
      lat: string;
      lng: string;
    };
  };
  phone: string;
  website: string;
  company: {
    name: string;
    catchPhrase: string;
    bs: string;
  };
}
```

### API Service Implementation
[Source: docs/architecture/components.md, docs/architecture/frontend-architecture.md]

Add to `lib/api/users.ts`:
```typescript
import { apiFetch } from './client';
import { userSchema } from './schemas';
import type { User } from '@/types';

export async function fetchUser(id: number): Promise<User> {
  return apiFetch(`/users/${id}`, undefined, userSchema);
}
```

### React Query Hook
[Source: docs/architecture/components.md, docs/architecture/frontend-architecture.md]

Add to `lib/hooks/use-users.ts`:
```typescript
import { useQuery } from '@tanstack/react-query';
import { fetchUser } from '@/lib/api/users';
import { queryKeys } from '@/lib/query-keys';

export function useUser(id: number) {
  return useQuery({
    queryKey: queryKeys.users.detail(id),
    queryFn: () => fetchUser(id),
    staleTime: 5 * 60 * 1000, // 5 minutes
    cacheTime: 10 * 60 * 1000, // 10 minutes
    retry: (failureCount, error: any) => {
      // Don't retry on 404
      if (error?.statusCode === 404) return false;
      return failureCount < 2;
    },
  });
}
```

### Component Structure
[Source: docs/architecture/components.md]

Components to create:
- `components/users/user-profile.tsx` - Main profile layout with sections
- Reuse `components/users/user-avatar.tsx` from Story 2.1

### Dynamic Route Implementation
[Source: docs/architecture/frontend-architecture.md]

The page component should extract the ID from params:
```typescript
interface UserProfilePageProps {
  params: {
    id: string;
  };
}

export default function UserProfilePage({ params }: UserProfilePageProps) {
  const userId = parseInt(params.id, 10);
  const { data: user, isLoading, isError } = useUser(userId);

  // Handle loading, error, and success states
}
```

### shadcn/ui Components Needed
[Source: docs/architecture/tech-stack.md]

Install these shadcn/ui components if not already added:
- Card (for section containers)
- Separator (for dividing sections)
- Badge (optional, for username display)
- Skeleton (for loading states)

Commands:
```bash
pnpm dlx shadcn@latest add card
pnpm dlx shadcn@latest add separator
pnpm dlx shadcn@latest add badge
pnpm dlx shadcn@latest add skeleton
```

### Website Link Implementation
For clickable website links:
```typescript
<a
  href={`https://${user.website}`}
  target="_blank"
  rel="noopener noreferrer"
  className="text-blue-600 hover:underline"
>
  {user.website}
</a>
```

### Static Map Placeholder Implementation
Create a simple placeholder component:
```typescript
interface MapPlaceholderProps {
  lat: string;
  lng: string;
}

function MapPlaceholder({ lat, lng }: MapPlaceholderProps) {
  return (
    <div className="w-full h-[200px] bg-slate-200 rounded-lg flex items-center justify-center">
      <div className="text-center">
        <div className="text-slate-500 font-semibold mb-2">Map</div>
        <div className="text-xs text-slate-400">
          {lat}, {lng}
        </div>
      </div>
    </div>
  );
}
```

### Breadcrumb Navigation Implementation
Create a simple breadcrumb component:
```typescript
import Link from 'next/link';

<nav aria-label="Breadcrumb" className="mb-6">
  <ol className="flex items-center gap-2 text-sm">
    <li><Link href="/" className="hover:underline">Home</Link></li>
    <li className="text-slate-400">/</li>
    <li><Link href="/users" className="hover:underline">Users</Link></li>
    <li className="text-slate-400">/</li>
    <li className="font-semibold">{user.name}</li>
  </ol>
</nav>
```

### Responsive Layout
[Source: docs/architecture/coding-standards.md]

Use a responsive grid for sections:
```typescript
<div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
  <Card>Contact Information</Card>
  <Card>Company Information</Card>
  <Card className="lg:col-span-2">Address</Card>
</div>
```

### Error Handling for 404
[Source: docs/architecture/coding-standards.md]

Handle missing user gracefully:
```typescript
if (isError && error?.statusCode === 404) {
  return (
    <div className="max-w-2xl mx-auto text-center py-12">
      <h1 className="text-2xl font-bold mb-4">User Not Found</h1>
      <p className="text-slate-600 mb-6">
        The user you're looking for doesn't exist.
      </p>
      <Link href="/users">
        <Button>Back to Users Directory</Button>
      </Link>
    </div>
  );
}
```

### Coding Standards
[Source: docs/architecture/coding-standards.md]

- File naming: kebab-case (e.g., `user-profile.tsx`)
- Component naming: PascalCase (e.g., `UserProfile`, `MapPlaceholder`)
- Props interfaces: PascalCase with 'Props' suffix
- Use TypeScript strict mode - no `any` types
- Validate API responses with Zod schemas
- Always show skeletons during data fetching
- Handle error states gracefully

### Accessibility Requirements
[Source: docs/architecture/coding-standards.md, docs/architecture/tech-stack.md]

- Use semantic HTML (header, section, nav elements)
- Add proper heading hierarchy (h1 for name, h2 for sections)
- Add aria-label to breadcrumb navigation
- Ensure external links have rel="noopener noreferrer"
- Add proper focus states to interactive elements
- Ensure color contrast meets WCAG AA standards

### Testing
[Source: docs/architecture/testing-strategy.md]

Unit tests to create:
- `tests/unit/components/users/user-profile.test.tsx` - Test rendering sections, data display
- `tests/unit/hooks/use-users.test.ts` - Test single user query hook, 404 handling

E2E tests to create:
- `tests/e2e/users/view-user-profile.spec.ts` - Test navigation to profile, data display, breadcrumb

Test requirements:
- Verify all user information sections are displayed
- Test loading skeleton appears while fetching
- Test 404 error handling for invalid user ID
- Verify breadcrumb navigation works
- Test website link opens in new tab
- Test responsive layout at different breakpoints
- Verify avatar displays correctly

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-09-30 | 1.0 | Initial story creation | Bob (Scrum Master) |

## Dev Agent Record

### Agent Model Used
_To be filled by Dev Agent_

### Debug Log References
_To be filled by Dev Agent_

### Completion Notes
_To be filled by Dev Agent_

### File List
_To be filled by Dev Agent_

## QA Results
_To be filled by QA Agent_